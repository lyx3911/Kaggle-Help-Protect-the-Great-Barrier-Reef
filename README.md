# Kaggle-Help-Protect-the-Great-Barrier-Reef

kaggleä¸Šçš„ä¸€ä¸ªå¥–é‡‘èµ›ï¼štensorFlow - Help Protect the Great Barrier Reef (Detect crown-of-thorns starfish in underwater image data) 

è¯¦ç»†ä»‹ç»ï¼š[TensorFlow - Help Protect the Great Barrier Reef | Kaggle](https://www.kaggle.com/c/tensorflow-great-barrier-reef/overview)

## èµ›äº‹ç®€ä»‹

è¿™é¡¹æ¯”èµ›çš„ç›®æ ‡æ˜¯é€šè¿‡çŠç‘šç¤çš„æ°´ä¸‹è§†é¢‘å»ºç«‹ç›®æ ‡æ£€æµ‹æ¨¡åž‹ï¼Œå®žæ—¶å‡†ç¡®åœ°è¯†åˆ«æµ·æ˜Ÿã€‚

æ•°æ®ä¸ºè‹¥å¹²æ®µè§†é¢‘ï¼Œå…±23502å¸§è§†é¢‘ï¼Œä½†å…¶ä¸­å¤§å¤šæ•°å¸§éƒ½æ²¡æœ‰å¾…æ£€æµ‹çš„ç›®æ ‡ã€‚

å‚åŠ è¿™ä¸ªæ¯”èµ›çš„åŽŸå› æ˜¯ä¸€æ¥å¯’å‡æ²¡äº‹åšï¼ŒäºŒæ¥è§‰å¾—è¿™ä¸ªæ¯”èµ›å’Œæˆ‘ä¹‹å‰è°ƒç ”è¿‡çš„Video Object Detectionæ¯”è¾ƒç›¸å…³ã€‚

## æ¨¡åž‹å’Œæ•°æ®é›†

æ¨¡åž‹ï¼šyolov5s (é¢„è®­ç»ƒçš„å‚æ•°)

æ•°æ®é›†ï¼škaggleæä¾›çš„è®­ç»ƒé›†ï¼Œæœªä½¿ç”¨é¢å¤–æ•°æ®ã€‚

è¯„ä¼°æŒ‡æ ‡ï¼šF2-score

## ç¡¬ä»¶å’Œè½¯ä»¶

è®¾å¤‡ï¼š2080Ti

ç³»ç»Ÿï¼šUbuntu 18.0

æ·±åº¦å­¦ä¹ æ¡†æž¶ï¼šPytorch1.8

## æ–¹æ³•

#### è¿‡ç¨‹

é¢˜å¤–è¯ï¼šè¿™ä¸ªæ¯”èµ›æ˜¯æ‹¿ä¸åˆ°æµ‹è¯•æ•°æ®çš„ï¼Œéœ€è¦ç”¨å®˜æ–¹æä¾›çš„æ•°æ®æŽ¥å£å†™å¥½è‡ªå·±çš„æŽ¨ç†ä»£ç ï¼Œå¹¶ä¸”æäº¤çš„notebookéœ€è¦èƒ½å¤Ÿä¸è”ç½‘è¿è¡Œï¼Œè¿™å°±å¯¼è‡´é…çŽ¯å¢ƒéžå¸¸å¤æ‚ã€‚æœ¬æ¥æˆ‘æ˜¯æƒ³ç”¨MMDetectionçš„ï¼Œä½†æ˜¯åœ¨Kaggleä¸Šé…ç½®èƒ½ä¸è”ç½‘è¿è¡Œçš„MMDetectionçŽ¯å¢ƒçœŸçš„å¤ªæŠ˜ç£¨äº†ï¼Œè™½ç„¶æœ€åŽå‚è€ƒå¤§ä½¬çš„æ•™ç¨‹é…å¥½äº†ï¼Œä½†æ˜¯æ¯æ¬¡è°ƒè¯•éƒ½è¦é‡æ–°ç¼–è¯‘mmcv-fullçœŸçš„å¤ªéš¾å—äº†ã€‚æ‰€ä»¥æœ€åŽè¿˜æ˜¯é€‰æ‹©äº†æ›´åŠ æ–¹ä¾¿çš„yolov5ã€‚

##### æ•°æ®é¢„å¤„ç†ï¼š

è®­ç»ƒæ•°æ®ä¸€å…±ä¸‰æ®µé•¿è§†é¢‘ï¼Œæˆ‘åˆ é™¤äº†è®­ç»ƒå›¾ç‰‡ä¸­æ²¡æœ‰å¾…æ£€æµ‹ç›®æ ‡çš„å¸§ï¼Œå‰©ä¸‹çš„å¸§å¤§çº¦å±žäºŽ20å¤šä¸ªå°è§†é¢‘ç‰‡æ®µï¼Œå°†è¿™äº›ç‰‡æ®µæŒ‰10foldåˆ’åˆ†äº†è®­ç»ƒé›†å’ŒéªŒè¯é›†ï¼Œæ²¡æœ‰ç›´æŽ¥éšæœºåˆ’åˆ†çš„åŽŸå› æ˜¯è§†é¢‘ç›¸é‚»ä¸¤å¸§çš„å·®å¼‚æ¯”è¾ƒå°ï¼Œå¦‚æžœéšæœºåˆ’åˆ†ä¼šé€ æˆéªŒè¯é›†æ³„éœ²ã€‚

å°†æ ‡ç­¾å¤„ç†æˆyolov5çš„æ ¼å¼ã€‚

æ•°æ®ç¤ºä¾‹å¦‚ä¸‹ï¼š

![example](./example.jpg)

- **baselineï¼š**yolov5sè®­ç»ƒä¸Šè¿°å¤„ç†åŽçš„æ•°æ®ï¼Œæ‰€æœ‰çš„å‚æ•°éƒ½è®¾ä¸ºé»˜è®¤å€¼ï¼Œä»…ä¿®æ”¹image sizeä¸º1280ï¼ˆå› ä¸ºå›¾ç‰‡çš„å°ºå¯¸ä¸º1920*720ï¼‰scoreï¼š0.45
- **æ›´å¤æ‚çš„æ¨¡åž‹ï¼š**å°è¯•yolo5lï¼Œscoreï¼š0.49ï¼Œæœ¬æ¥æƒ³å°è¯•yolo5xï¼Œä½†æ˜¯æ˜¾å­˜ä¸å¤Ÿï¼Œsizeä¸º1280æ—¶å•å¡batchsizeå°±åªèƒ½è®¾ä¸º1äº†ï¼Œå³ä½¿ä½¿ç”¨äº†å››å¡å¹¶è¡Œæ•ˆçŽ‡ä¹Ÿå¾ˆä½Žï¼Œé‚æ”¾å¼ƒã€‚
- **æ›´å¤§çš„image sizeï¼š**å°è¯•åœ¨éªŒè¯çš„æ—¶å€™å¢žå¤§image sizeï¼Œå‘çŽ°åœ¨éªŒè¯é›†ä¸Šçš„scoreæœ‰æ‰€æå‡ã€‚äºŽæ˜¯å°è¯•è®­ç»ƒæ—¶ä¹Ÿä½¿ç”¨æ›´å¤§çš„image sizeï¼ŒéšåŽå°è¯•ä¸‹æ¥è®­ç»ƒçš„æ—¶å€™image sizeè®¾ä¸º2560ï¼ŒæŽ¨ç†çš„æ—¶å€™image sizeè®¾ä¸º4800çš„æ•ˆæžœæ˜¯æœ€å¥½çš„ã€‚ï¼ˆåœ¨kaggleè®¨è®ºåŒºçœ‹åˆ°å¾ˆå¤šHigh resolution is all you needçš„å¸–å­ï¼Œä»–ä»¬ç”šè‡³å°è¯•äº†3600çš„image sizeæ¥è®­ç»ƒï¼Œimage size=10000æ¥æŽ¨ç†ï¼Œæˆ‘åªèƒ½è¯´æ˜¾å­˜å¤§äº†ä¸èµ·å•Šã€‚ä¸è¿‡çº¿ä¸‹å°è¯•çš„æ—¶å€™æ›´å¤§çš„image sizeå¹¶æ²¡æœ‰èµ·ä½œç”¨ï¼ŒçŒœæµ‹å¯èƒ½ä»–ä»¬åšæ•°æ®å¢žå¼ºçš„æ—¶å€™ç¼©æ”¾æ¯”ä¾‹æ›´å¤§ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘batchszieå¤ªå°ï¼‰scoreï¼š0.6å·¦å³
- **Test-Time Augmentationï¼š**æŽ¨ç†æ—¶è¿›è¡Œæ•°æ®å¢žå¼ºï¼Œç„¶åŽå¯¹å¢žå¼ºåŽçš„é¢„æµ‹ç»“æžœè¿›è¡Œèžåˆï¼Œä¸ºyolov5è‡ªå¸¦çš„åŠŸèƒ½ã€‚èƒ½ç¨å¾®æå‡ä¸€ç‚¹ç‚¹åˆ†æ•°ï¼ŒçœŸå°±ä¸€ç‚¹ç‚¹ã€‚
- **æ•°æ®å¢žå¼ºï¼š**è°ƒæ•´äº†ä¸€ä¸‹é»˜è®¤çš„æ•°æ®å¢žå¼ºæ–¹å¼ï¼ŒåŠ å¼ºäº†HSVå˜æ¢ï¼Œæ‰©å¤§äº†ç¼©æ”¾ç³»æ•°ï¼Œmixupå’Œcutpasteåˆ†åˆ«è®¾ä¸º0.5ã€‚
- **è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼ï¼š**é»˜è®¤çš„é˜ˆå€¼ä¸º0.6ï¼Œå¤ªé«˜äº†ã€‚å› ä¸ºæµ·æ˜Ÿæ˜¯æ¯”è¾ƒå®¹æ˜“å’ŒèƒŒæ™¯æ··æ·†çš„ç›®æ ‡ï¼Œè§‚å¯Ÿæ¨¡åž‹çš„è¾“å‡ºå‘çŽ°æœ‰å¾ˆå¤šç½®ä¿¡åº¦åªæœ‰0.3å·¦å³çš„æ£€æµ‹æ¡†å…¶å®žæ˜¯æ­£ç¡®çš„ã€‚åŒæ—¶è¿™ä¸ªæ¯”èµ›çš„è¯„ä¼°å‡½æ•°æ˜¯F2-scoreï¼Œæ‰€ä»¥å¬å›žçŽ‡æ›´åŠ é‡è¦ã€‚ä¿®æ”¹äº†yolov5ä¸­çš„f1-scoreè®¡ç®—å‡½æ•°ï¼Œåœ¨logæ–‡ä»¶ä¸­è®°å½•æ¯ä¸€è½®çš„f2-scoreã€‚æ¨¡åž‹è®­ç»ƒå®ŒæˆåŽï¼Œè§‚å¯Ÿåœ¨éªŒè¯é›†ä¸Šçš„f2-scoreæ›²çº¿ï¼Œé€‰æ‹©æœ€å¥½çš„ç½®ä¿¡åº¦é˜ˆå€¼ã€‚é˜ˆå€¼è®¾ä¸º0.45çš„æ—¶å€™ï¼Œåˆ†æ•°å¯ä»¥è¾¾åˆ°0.65å·¦å³ã€‚
- **Trackingï¼š**å› ä¸ºæ˜¯è§†é¢‘ä¿¡æ¯ï¼Œæ‰€ä»¥å°†å‰åŽå¸§å…³è”èµ·æ¥ä¸€å®šæ¯”å•çœ‹ä¸€å¸§å›¾åƒæ›´å¥½ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ç›®æ ‡è·Ÿè¸ªå™¨è·Ÿè¸ªæ¯ä¸€ä¸ªæµ·æ˜Ÿï¼Œå¹¶é¢„æµ‹å®ƒåœ¨ä¸‹ä¸€å¸§ä¼šå‡ºçŽ°çš„ä½ç½®å’Œæ¦‚çŽ‡ï¼Œä¸Žä¸‹ä¸€å¸§çš„ç›®æ ‡æ£€æµ‹ç»“æžœè¿›è¡Œèžåˆï¼Œå…·ä½“çš„å®žçŽ°å€ŸåŠ©äº†[norfair](https://github.com/tryolabs/norfair)åº“ï¼Œæ‰€ä»¥å®žçŽ°èµ·æ¥å¹¶ä¸å¤æ‚ã€‚

#### æœ€ç»ˆæ–¹æ¡ˆ

æ¨¡åž‹ï¼šyolov5sï¼Œä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡åž‹åˆå§‹åŒ–ã€‚

è®­ç»ƒæ—¶çš„image sizeä¸º2560ï¼ŒæŽ¨ç†æ—¶çš„sizeä¸º4800ï¼Œå¹¶è¿›è¡ŒTest-Time Augmentationï¼Œç½®ä¿¡åº¦é˜ˆå€¼ä¸º0.45ã€‚

ä½¿ç”¨ç›®æ ‡è·Ÿè¸ªç®—æ³•ç»“åˆå‰é¢å‡ å¸§çš„æ£€æµ‹ç»“æžœå¯¹å½“å‰å¸§è¿›è¡Œä¿®æ­£ã€‚

æœ€ç»ˆæäº¤çš„notebookï¼š`yolov5-tracking.ipynb`

#### å…¶ä»–æ–¹æ¡ˆ

å°è¯•äº†ä¸€äº›ï¼ˆæˆ–è€…æ¥ä¸åŠå°è¯•ï¼‰æˆ‘è§‰å¾—å¯èƒ½ä¼šæœ‰ç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯åˆ†æ•°å¹¶æ²¡æœ‰æé«˜ï¼š

- **Model Ensembleï¼š**10æŠ˜äº¤å‰éªŒè¯ï¼Œé€‰å–å…¶ä¸­ä¸‰æŠ˜è®­ç»ƒçš„æ¨¡åž‹è¿›è¡ŒWBFèžåˆï¼ˆç›®æ ‡æ¡†åŠ æƒèžåˆï¼‰ï¼Œåˆ©ç”¨ensemble_boxes PyPIå®žçŽ°ï¼Œæäº¤è¿‡ä¸€æ¬¡æ•ˆæžœå¹¶ä¸å¥½ï¼ŒåŽé¢ä¹Ÿæ²¡æœ‰æ—¶é—´è®­ç»ƒæ›´å¤šçš„æ¨¡åž‹ç”¨äºŽè°ƒè¯•ï¼Œæ‰€ä»¥å°±æ”¾å¼ƒäº†ã€‚

- åŠ å…¥ä¸€éƒ¨åˆ†æ²¡æœ‰ç›®æ ‡çš„è®­ç»ƒé›†ï¼šæŒ‰ç…§yolov5å®˜æ–¹æ–‡æ¡£ä¸­æŽ¨èçš„ï¼ŒåŠ äº†10%ï¼Œæ²¡ä»€ä¹ˆç”¨ã€‚

- label smoothï¼šæ²¡ç”¨

- **æ»‘çª—ï¼š**åœ¨è¾ƒå¤§çš„å›¾ç‰‡è¿›è¡Œæ£€æµ‹æ—¶ï¼Œé¦–å…ˆä½¿ç”¨æ»‘åŠ¨çª—å£æ³•å¯¹å›¾åƒè¿›è¡Œåˆ‡ç‰‡ï¼Œå°†åˆ‡ç‰‡è¾“å…¥ç½‘ç»œï¼Œå†å¯¹å¾—åˆ°çš„é¢„æµ‹ç»“æžœè¿›è¡Œæ‹¼æŽ¥ï¼Œå€ŸåŠ©[SAHI](https://github.com/obss/sahi)å®žçŽ°ã€‚è®¾ç½®çš„æ»‘åŠ¨çª—å£å¤§å°ä¸º512*512ï¼Œoverlap=0.2ï¼Œä½†æ˜¯åˆ†æ•°åè€Œä¸‹é™äº†ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è®­ç»ƒçš„æ—¶å€™å›¾åƒä¸ºæ•´å¼ è¾“å…¥ï¼Œæ‰€ä»¥å¯¹è®­ç»ƒé›†çš„å›¾ç‰‡è¿›è¡Œcropï¼Œåˆ é™¤äº†æ²¡æœ‰ç›®æ ‡çš„éƒ¨åˆ†ï¼Œé‡æ–°è®­ç»ƒæ¨¡åž‹ï¼Œä½†ä¾ç„¶æ²¡æœ‰æå‡ã€‚ç”±äºŽæ—¶é—´å’Œç®—åŠ›çš„å…³ç³»å°±æ²¡æœ‰æ·±å…¥ç ”ç©¶äº†ã€‚

- **soft-NMSï¼š**å°†yolov5çš„åŽå¤„ç†æ¨¡å—NMSæ”¹æˆsoft-NMSï¼Œå’Œä¸æ”¹æ²¡ä»€ä¹ˆåŒºåˆ«

- **tph-yolov5ï¼š**åœ¨å…¶ä»–æ¯”èµ›çš„ç»éªŒå¸–ä¸­çœ‹åˆ°çš„ï¼Œç»™yolov5åŠ äº†åŸºäºŽtransformerç»“æž„çš„å°ç›®æ ‡æ£€æµ‹å¤´ï¼Œå…·ä½“å¯è§æˆ‘é­”æ”¹è¿‡çš„yolov5ï¼š`yolov5/models/common.py`ã€‚ç”¨è¿™ä¸ªæ”¹è¿‡çš„yolov5sæ¯”ä¸æ”¹çš„æ›´å·®ï¼Œå¯èƒ½æ˜¯å› ä¸ºæœ¬èº«è®­ç»ƒæ•°æ®ä¹Ÿä¸æ˜¯å¾ˆå¤šï¼Œtph-yolov5æ²¡æœ‰é¢„è®­ç»ƒçš„æ¨¡åž‹ã€‚ï¼ˆyolov5séšæœºåˆå§‹åŒ–è¦æ¯”ä½¿ç”¨é¢„è®­ç»ƒæ¨¡åž‹ä½Ž0.08å·¦å³ï¼‰

- æ°´ä¸‹æ•°æ®é¢„å¤„ç†ï¼šç”¨äº†[Scalsol/mega.pytorch: Memory Enhanced Global-Local Aggregation for Video Object Detection, CVPR2020 (github.com)](https://github.com/Scalsol/mega.pytorch)ä¸­å®žçŽ°çš„ä¸€äº›æ–¹æ³•ï¼Œå¹¶å¯è§†åŒ–äº†å¤„ç†ç»“æžœï¼Œæœ€åŽç»“åˆå¤„ç†æ—¶é—´å’Œæ•ˆæžœï¼Œé€‰æ‹©äº†CLAHEç®—æ³•å¯¹å›¾åƒè¿›è¡Œé¢„å¤„ç†ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆæ•ˆæžœã€‚å¯èƒ½æ˜¯è¿™ä¸ªè™½ç„¶æ˜¯æ°´ä¸‹å›¾åƒï¼Œä½†å·²ç»è¶³å¤Ÿæ¸…æ™°äº†ï¼Œå¤„ç†ä¹‹åŽçš„å›¾åƒè´¨é‡ä¹Ÿå¹¶æ²¡æœ‰æ˜Žæ˜¾æé«˜ï¼Œåè€Œè¿œå¤„çš„è‰²å½©è¿˜å‡ºçŽ°äº†åå·®

- Image blendingæ•°æ®å¢žå¼ºï¼šä¸å¦‚ç›´æŽ¥cut-pasteç®€å•å¥½ç”¨

- **Video Anomaly Detection**é¢†åŸŸç”¨åˆ°çš„æ–¹æ³•

  ç”±äºŽè¿™æ˜¯è§†é¢‘ç›®æ ‡æ£€æµ‹ï¼Œæ‰€ä»¥æƒ³å°è¯•ä¸€äº›è®ºæ–‡ä¸­çœ‹èµ·æ¥éžå¸¸novalçš„æ–¹æ³•ï¼Œä½†æ˜¯çœŸçš„åŽ»åšçš„æ—¶å€™å‘çŽ°å¾ˆå¤šæ–¹æ³•éƒ½ä¸èƒ½å®žçŽ°å®žæ—¶æ£€æµ‹ï¼Œæœ‰äº›æ–¹æ³•ç”±äºŽå¼€æºä»£ç ä¸å®Œæ•´ç­‰åŽŸå› ï¼Œå¯¼è‡´å¤çŽ°çš„è¿‡ç¨‹é‡åˆ°å¾ˆå¤šå›°éš¾ï¼Œæœ€åŽçœŸçš„è¯•è¿‡çš„å°±ä¸‹é¢è¿™ä¸¤ç§ï¼š

  - [seq-NMS](https://arxiv.org/abs/1602.08465)ï¼šè¿™ä¸ªæ–¹æ³•çš„æ€è·¯ç®€å•ç›´æŽ¥ï¼Œå¯¹æ•´ä¸ªè§†é¢‘çš„å€™é€‰æ¡†ï¼ˆè¿›å…¥åŽå¤„ç†æ¨¡å—NMSä¹‹å‰ï¼‰ç»Ÿä¸€è¿›è¡Œå¤„ç†ï¼š

    - ç›¸é‚»ä¸¤å¸§ä¹‹é—´çš„å€™é€‰æ¡†å¦‚æžœIoUè¶…è¿‡é˜ˆå€¼ï¼Œè®¤ä¸ºå¯èƒ½æ˜¯åŒä¸€ä¸ªç‰©ä½“ï¼Œå°†ä»–ä»¬è¿žæŽ¥èµ·æ¥ã€‚å¯¹æ•´æ®µè§†é¢‘ï¼Œæ‰¾åˆ°ä½¿è¿™ä¸ªåˆ†æ•°æœ€å¤§åŒ–çš„è¿žæŽ¥æ–¹å¼
    - å¯¹å±žäºŽåŒä¸€ä¸ªç‰©ä½“çš„å€™é€‰æ¡†åˆ†æ•°è¿›è¡Œè°ƒæ•´ï¼Œå–æœ€å¤§æˆ–è€…å–å¹³å‡
    - åœ¨æ¯ä¸€å¸§ä¸Šè¿è¡ŒNMSç®—æ³•ï¼Œä½¿ç”¨è°ƒæ•´åŽçš„åˆ†æ•°ã€‚

    å…¶å®žè¿™ä¹Ÿæ˜¯ä¸€ä¸ªç¦»çº¿çš„å¤„ç†è¿‡ç¨‹ï¼Œæˆ‘ç¨å¾®é­”æ”¹äº†ä¸€ä¸‹ï¼š

    - å¯¹å‰å‡ å¸§ä¸åšå¤„ç†ï¼Œåªä¿ç•™ä½Žç½®ä¿¡åº¦é˜ˆå€¼ä¸‹çš„bboxes list
    - å¯¹è¿žç»­10å¸§ï¼ˆå½“å‰å¸§+å‰9å¸§ï¼‰çš„bboxes listä½¿ç”¨seq-NMSç®—æ³•å¤„ç†ï¼Œå¤„ç†ä¹‹åŽçš„åˆ†æ•°å†ä½¿ç”¨é˜ˆå€¼0.45è¿›è¡Œè¿‡æ»¤ã€‚

    æ²¡æœ‰å¾—åˆ°ä»€ä¹ˆæå‡ï¼Œä½†æˆ‘è§‰å¾—è¿™ä¸ªæ–¹æ³•å¾ˆç®€æ´åŒæ—¶ä¸éœ€è¦æ”¹å˜yolov5çš„æ¨¡åž‹ï¼Œæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ½œåŠ›çš„æ–¹æ³•ï¼Œè™½ç„¶åŽé¢æ¥ä¸åŠä¼˜åŒ–äº†ã€‚ã€‚ã€‚

    æˆ‘è®¤ä¸ºç›®å‰çš„ä¸»è¦ç¼ºé™·åœ¨äºŽæ²¡æœ‰åˆ¤æ–­å½“å‰å¸§æ˜¯å¦æ˜¯å±žäºŽå‰ä¸€æ®µè§†é¢‘çš„ï¼ˆä¸ç¡®å®šçº¿ä¸Šçš„æµ‹è¯•é›†æ˜¯å¦æ¥æºäºŽä¸€æ®µå®Œæ•´çš„è§†é¢‘ï¼‰ï¼Œå¦‚æžœå…¶ä¸­å‘ç”Ÿäº†è§†é¢‘ç‰‡æ®µçš„åˆ‡æ¢ï¼Œseq-NMSå¯èƒ½ä¼šäº§ç”Ÿé”™è¯¯çš„å…³è”ã€‚

  - [MEGA](https://arxiv.org/abs/2003.12063)ï¼šå·®ä¸å¤šæ˜¯è¿™å‡ å¹´Video Object Detectioné¢†åŸŸçš„SOTAäº†ï¼Œä½œè€…æ˜¯ä¸ªå·¨ä½¬ï¼ŒåŸºäºŽmaskrcnn_benchmarkå®žçŽ°äº†å¾ˆå¤šVODæ–¹å‘çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ä»–è‡ªå·±çš„ã€‚æˆ‘åœ¨è¿™ä¸ªæµ·æ˜Ÿæ•°æ®é›†ä¸Šåšäº†ä¸€ä¸‹å®žéªŒï¼Œæ•ˆæžœå¹¶ä¸ç†æƒ³ã€‚ä¸è¿‡è¿™ä¸ªé¢†åŸŸç›®å‰éƒ½æ˜¯åœ¨ImageNet VIDä¸Šåšçš„å®žéªŒï¼Œè¿™ä¸ªæ•°æ®é›†çš„ç›®æ ‡éƒ½æ¯”è¾ƒå¤§ï¼Œåˆ†å¸ƒæ¯”èµ›æ•°æ®é›†å¾ˆä¸ä¸€æ ·ï¼Œç®—æ³•æ²¡æœ‰å›¾åƒç›®æ ‡æ£€æµ‹è¿™ä¹ˆä¹…ç»è€ƒéªŒï¼Œæ³›åŒ–èƒ½åŠ›ä¹Ÿä¸å¼ºã€‚æ‰€ä»¥æˆ‘è®¤ä¸ºç›®å‰åœ¨å°æ•°æ®é›†ä¸Šè¿›è¡Œè§†é¢‘ç›®æ ‡æ£€æµ‹è¿˜æ˜¯ç”¨å›¾åƒç›®æ ‡æ£€æµ‹+åŽå¤„ç†æ¨¡å—æ›´åˆé€‚ã€‚

- **ä¼ªè£…ç›®æ ‡æ£€æµ‹ï¼ˆCamouflage Object Detectionï¼‰ï¼š**

  ä¼ ç»Ÿçš„æ˜¾è‘—æ€§ç›®æ ‡æ£€æµ‹ï¼ˆSODï¼‰çš„å·¥ä½œåŽŸç†æ˜¯è¯†åˆ«å›¾åƒä¸­æœ€å¼•äººæ³¨æ„çš„ç›®æ ‡ï¼Œç„¶è€Œï¼Œåƒæµ·æ˜Ÿè¿™ç§å’ŒèƒŒæ™¯æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„çš„ç›®æ ‡ï¼Œä½¿å¾—å®ƒå¾ˆéš¾è¢«å‘çŽ°ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯ä¼ªè£…ç›®æ ‡æ£€æµ‹ï¼ˆSODï¼‰ã€‚ä¸è¿‡çœ‹äº†å‡ ç¯‡æ–‡ç« éƒ½æ˜¯éœ€è¦åƒç´ çº§maskæ¥è®­ç»ƒçš„ï¼Œä½†æ„Ÿè§‰è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæŒºæœ‰æ„æ€çš„å°é¢†åŸŸã€‚

## æœ€ç»ˆæˆç»©

é“¶ç‰Œ top4%

Aæ¦œï¼š0.679

Bæ¦œï¼š0.683

## æ„Ÿæƒ³

ç¬¬ä¸€æ¬¡æ‰“kaggleï¼Œèƒ½æ‹¿åˆ°é“¶ç‰Œä¹Ÿå¾ˆå¼€å¿ƒäº†ã€‚è¿™æ¬¡å¸å–äº†ä¸Šæ¬¡å¤©æ± çš„ç»éªŒæ•™è®­ï¼Œæ¯”è¾ƒæ³¨é‡çº¿ä¸‹éªŒè¯çš„ç»“æžœï¼Œæ‰€ä»¥æœ€åŽBæ¦œä¹Ÿæ²¡æœ‰ç¿»è½¦ï¼Œæœ¬æ¥æœ€åŽAæ¦œéƒ½å·²ç»æŽ‰åˆ°é“œç‰ŒåŒºäº†ï¼Œæ„Ÿè§‰å·²ç»æ²¡äº†ï¼Œæœ€åŽæŒ‘äº†åˆ†æ•°æœ€é«˜çš„ç‰ˆæœ¬å’Œ3ä¸ªçº¿ä¸‹éªŒè¯æœ€å¥½çš„ç‰ˆæœ¬ä½œä¸ºæœ€ç»ˆæäº¤ã€‚æ²¡æƒ³åˆ°æœ€åŽBæ¦œä¸€å¼€ï¼Œå¾ˆå¤šAæ¦œåˆ†æ•°é å‰çš„äººæŽ’åéƒ½ä¸‹é™äº†ï¼Œæœ€åŽæˆåŠŸæ‹¿åˆ°é“¶ç‰Œï¼Œå®žçŽ°å°ç›®æ ‡ã€‚

æ¯”è¾ƒé—æ†¾çš„æ˜¯å½“æ—¶å¼€å§‹è¿™ä¸ªæ¯”èµ›æ¯”è¾ƒæ™šäº†ï¼Œæ—¶é•¿ä¸‰ä¸ªæœˆçš„æ¯”èµ›æˆ‘å¼€å§‹åšçš„æ—¶å€™åªæœ‰ä¸€ä¸ªæœˆäº†ï¼Œå—é™äºŽæ—¶é—´å’Œç®—åŠ›ï¼Œæœ‰å¾ˆå¤šæƒ³æ³•éƒ½æ¥ä¸åŠå°è¯•å’Œä¼˜åŒ–ã€‚

## TOPæ–¹æ¡ˆæ€»ç»“

å› ä¸ºkaggleä¹Ÿæ²¡æœ‰å¼ºåˆ¶Topæ–¹æ¡ˆè¦å…¬å¼€ï¼Œæ‰€ä»¥æˆ‘å°½æˆ‘æ‰€èƒ½æ‰¾äº†å…¬å¼€çš„topæ–¹æ¡ˆï¼Œæ€»ç»“äº†ä¸€äº›å¯¹æˆ‘æ¥è¯´æœ‰å¯å‘çš„ã€‚

è¿™äº›æ–¹æ¡ˆåŸºæœ¬éƒ½ç”¨åˆ°äº†Model Ensembleå’Œtrackingç®—æ³•åšåŽå¤„ç†

##### Top1

3-fold cross validation splitï¼Œè®­ç»ƒäº†6ä¸ªæ¨¡åž‹ï¼ˆ3ä¸ªimage size=3648ï¼Œ3ä¸ªimage size=1536ï¼‰ï¼Œè¿›è¡Œæ¨¡åž‹é›†æˆï¼ŒAæ¦œåˆ†æ•°å¯ä»¥è¾¾åˆ°0.716

classification re-scoreï¼šåœ¨ç›®æ ‡æ£€æµ‹æ¨¡åž‹åŽé¢åŠ äº†ä¸€ä¸ªåˆ†ç±»ç½‘ç»œï¼Œå¯¹ç›®æ ‡æ£€æµ‹çš„ç»“æžœè¿›è¡Œre-scoreã€‚Aæ¦œåˆ†æ•°å¯ä»¥è¾¾åˆ°0.73

trackingåŽå¤„ç†ï¼Œæœ€ç»ˆ0.74+

è¿˜æ„Ÿè°¢HPç»™ä»–èµžåŠ©äº†A6000å·¥ä½œç«™ï¼Œä¸€å¼ å¡æ˜¾å­˜å°±48Gï¼Œæˆ‘chaoï¼Œæˆ‘é…¸äº†

##### Top2

åŸºäºŽYolo v5ï¼Œé€‰æ‹©äº†yolo v5lã€‚ä½¿ç”¨äº†æ¨¡åž‹é›†æˆï¼Œé›†æˆäº†åœ¨11ä¸ªä¸åŒåˆ†è¾¨çŽ‡è®­ç»ƒå’ŒæŽ¨ç†ä¸‹çš„4ä¸ªæ¨¡åž‹ï¼Œæœ€ç»ˆä»…æ£€æµ‹å°±è¾¾åˆ°äº†0.737ã€‚è‡ªå·±å†™çš„å¾ˆæœ´ç´ çš„â€œattention areaâ€ trackingï¼ˆæˆ‘è®¤ä¸ºè¿™ä¸ªå¯èƒ½æ•ˆæžœæ²¡æœ‰æˆ‘ç”¨çš„å¥½ï¼Œä¸»è¦æ˜¯ä»–å•å¸§çš„æ£€æµ‹ç²¾åº¦å°±å¾ˆé«˜äº†ï¼‰

##### Top3

ä½¿ç”¨1152*2048çš„åˆ†è¾¨çŽ‡è®­ç»ƒäº†äº”ç§ä¸åŒç»“æž„çš„æ¨¡åž‹è¿›è¡Œé›†æˆï¼Œåˆ†åˆ«æ˜¯CenterNetã€FasterRCNNã€FCOSã€EfficientDetå’ŒYoloV5ã€‚trackingåŽå¤„ç†ã€‚

è¿˜æœ‰å…³äºŽLabel tightness & Public LBçš„è®¨è®ºï¼Œæ²¡å¤ªçœ‹æ‡‚ï¼Œå…ˆè®°ä¸€ä¸‹ï¼š[TensorFlow - Help Protect the Great Barrier Reef | Kaggle](https://www.kaggle.com/c/tensorflow-great-barrier-reef/discussion/307707)

##### Top5

5ä¸ªä¸åŒç»“æž„çš„æ¨¡åž‹é›†æˆï¼Œtrackingã€‚

Image blendingåšäº†æ•°æ®å¢žå¼ºã€‚

##### Top 7

åŸºäºŽCascade RCNN+trackingï¼Œä¹Ÿç”¨äº†æ¯”è¾ƒå¤§çš„image sizeï¼Œä½†æ˜¯æ²¡æœ‰å†™å…·ä½“æ˜¯å¤šå°‘

##### Top9

å°†åŽŸå›¾æ»‘çª—è£å‰ªä¸º320*320çš„å°å—ï¼Œstrideä¸º(240, 200)ã€‚å‘çŽ°è®­ç»ƒé›†ä¸­æœ‰å¾ˆå¤šé”™è¯¯çš„æ ‡ç­¾ï¼Œä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡åž‹ç”Ÿæˆä¼ªæ ‡ç­¾ä¸ŽåŽŸæ¥çš„æ ‡ç­¾æ¯”è¾ƒè¿›è¡Œæ ‡ç­¾çº æ­£ã€‚

ç”±äºŽè£å‰ªå‡ºçš„å›¾ç‰‡æ— ç›®æ ‡çš„å¾ˆå¤šï¼Œæ‰€ä»¥ä½¿ç”¨äº†class-balanced samplerï¼Œpos/neg ratioä¸º1:0.3

ä½†æ˜¯æŽ¨ç†çš„æ—¶å€™è¿˜æ˜¯æŠŠæ•´ä¸ªå›¾ç‰‡ç¼©æ”¾åˆ°2560ç›´æŽ¥æŽ¨ç†çš„

> Note: even though training with tiles, YOLOv5 model accurately detects the object when input with entire image.

åŽå¤„ç†æ¨¡å—ç”¨çš„æ˜¯Seq-NMSï¼Œå’Œæˆ‘çš„æƒ³æ³•ä¸€æ ·ï¼ï¼ï¼ï¼ä»–é­”æ”¹Seq-NMSçš„æ€è·¯ä¹Ÿè·Ÿæˆ‘å¤§è‡´ç›¸åŒã€‚æ ¹æ®ä½œè€…çš„æè¿°å·®ä¸å¤šæ¶¨äº†2-5%ã€‚å¦‚æžœèƒ½å¤šèŠ±ç‚¹æ—¶é—´ä¼˜åŒ–ä¸€ä¸‹Seq-NMSä¼šæ›´å¥½ã€‚

##### Top10

yolov5l image size=3000ï¼Œæ¨¡åž‹é›†æˆï¼Œtracking

##### æ€»ç»“

å‰æŽ’å‡ ä¹Žäººå‡é›†æˆäº”å…­ä¸ªæ¨¡åž‹ï¼Œå¼•å…¥trackingç®—æ³•åšåŽå¤„ç†ä¹Ÿæ˜¯åˆ†é«˜çš„äººéƒ½æƒ³åˆ°äº†ï¼Œè¿™ä¸€éƒ¨åˆ†æå‡çš„åˆ†æ•°éƒ½å·®ä¸å¤šï¼Œé™¤äº†åšäº†Seq-NMSçš„ç•¥é«˜ï¼Œæˆ‘å’Œå¤§ä½¬çš„å·®è·ä¸»è¦è¿˜æ˜¯åœ¨å•å¸§å›¾åƒæ£€æµ‹çš„æ€§èƒ½ä¸Šã€‚

å†æ¬¡æ„Ÿå¹å¡å¤šæ˜¾å­˜å¤§å°±æ˜¯å¥½å•Šï¼Œæœ‰é’±å°±æ˜¯ç‰›é€¼ã€‚

ä¹Ÿæœ‰ä¸€äº›æˆ‘æµ…å°æ²¡ç”¨å¾ˆå¿«å°±æ”¾å¼ƒçš„æ–¹æ³•è¢«å¤§ä½¬åšå‡ºæ¥äº†ï¼Œæ¯”å¦‚image blendingåšæ•°æ®å¢žå¼ºå’ŒSeq-NMSï¼Œè¿˜æ˜¯éœ€è¦åŠ å¼ºä»£ç èƒ½åŠ›å’Œåˆ†æžé—®é¢˜çš„èƒ½åŠ›ã€‚

ä¸€ä¸ªæœˆçš„æ—¶é—´å¤Ÿæ˜¯å¤Ÿï¼Œä½†æ˜¯æƒ³å¾—åˆ°æ›´å¥½çš„æˆç»©å¯èƒ½è¿˜æ˜¯è¦å¤šèŠ±ç‚¹æ—¶é—´ï¼Œå¯’å‡åœ¨å®¶ç¡®å®žä»£ç å†™å¾—å¿ƒä¸åœ¨ç„‰çš„ã€‚

## Reference

- [ultralytics/yolov5: YOLOv5 ðŸš€ in PyTorch > ONNX > CoreML > TFLite (github.com)](https://github.com/ultralytics/yolov5)
- [obss/sahi: A lightweight vision library for performing large scale object detection/ instance segmentation. (github.com)](https://github.com/obss/sahi)
- [lrghust/Seq-NMS: An implementation of Seq-NMS (github.com)](https://github.com/lrghust/Seq-NMS)
- [Scalsol/mega.pytorch: Memory Enhanced Global-Local Aggregation for Video Object Detection, CVPR2020 (github.com)](https://github.com/Scalsol/mega.pytorch)
